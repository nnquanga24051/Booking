@model Booking_Hotel.Models.ViewModels.AdminDashboardViewModel

@{
    ViewData["Title"] = "Admin Dashboard";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

@section Styles {
    <link rel="stylesheet" href="~/css/admin-dashboard.css" asp-append-version="true" />
}

<div class="dashboard-container">

    <!-- HEADER -->
    <div class="dashboard-header">
        <h1 class="dashboard-title">📊 Tổng Quan Hệ Thống</h1>
        <div class="header-actions">
            <button class="refresh-btn" onclick="location.reload()">🔄 Làm Mới</button>
            <span class="last-update">
                Cập nhật: @DateTime.Now.ToString("dd/MM/yyyy HH:mm")
            </span>
        </div>
    </div>

    <!-- STATS -->
    <div class="stats-grid">
        <div class="stat-card blue">
            <div class="stat-icon">👥</div>
            <div class="stat-content">
                <div class="stat-value">@Model.TotalUsers</div>
                <div class="stat-label">Tổng Người Dùng</div>
            </div>
        </div>

        <div class="stat-card green">
            <div class="stat-icon">🏨</div>
            <div class="stat-content">
                <div class="stat-value">@Model.TotalRooms</div>
                <div class="stat-label">Tổng Số Phòng</div>
            </div>
        </div>

        <div class="stat-card orange">
            <div class="stat-icon">📅</div>
            <div class="stat-content">
                <div class="stat-value">@Model.BookingsThisMonth</div>
                <div class="stat-label">Đặt Phòng Tháng Này</div>
            </div>
        </div>

        <div class="stat-card purple">
            <div class="stat-icon">💰</div>
            <div class="stat-content">
                <div class="stat-value">
                    @Model.TotalRevenue.ToString("N0") ₫
                </div>
                <div class="stat-label">Doanh Thu</div>
            </div>
        </div>
    </div>

    <!-- BOOKINGS + ROOM STATUS -->
    <div class="dashboard-grid">

        <!-- RECENT BOOKINGS -->
        <div class="dashboard-card recent-bookings">
            <div class="card-header">
                <h3>📋 Đặt Phòng Gần Đây</h3>
                <a href="/Admin/Bookings" class="view-all">Xem Tất Cả →</a>
            </div>
            <div class="card-body">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Khách Hàng</th>
                            <th>Phòng</th>
                            <th>Check-in</th>
                            <th>Check-out</th>
                            <th>Trạng Thái</th>
                            <th>Giá</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var b in Model.RecentBookings)
                        {
                            <tr>
                                <td>#@b.BookingId</td>
                                <td>@b.FullName</td>
                                <td>@b.RoomName</td>
                                <td>@b.CheckIn.ToString("dd/MM/yyyy")</td>
                                <td>@b.CheckOut.ToString("dd/MM/yyyy")</td>
                                <td>
                                    <span class="status-badge @b.Status.ToLower()">
                                        @b.Status
                                    </span>
                                </td>
                                <td>@b.Price.ToString("N0") ₫</td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>

        <!-- ROOM STATUS -->
        <div class="dashboard-card room-status">
            <div class="card-header">
                <h3>🏨 Tình Trạng Phòng</h3>
            </div>
            <div class="card-body">
                <div class="room-status-grid">
                    <div class="room-status-item">
                        <div class="status-circle available"></div>
                        <div class="status-info">
                            <div class="status-number">@Model.AvailableRooms</div>
                            <div class="status-text">Còn Trống</div>
                        </div>
                    </div>

                    <div class="room-status-item">
                        <div class="status-circle booked"></div>
                        <div class="status-info">
                            <div class="status-number">@Model.BookedRooms</div>
                            <div class="status-text">Đã Đặt</div>
                        </div>
                    </div>

                    <div class="room-status-item">
                        <div class="status-circle maintenance"></div>
                        <div class="status-info">
                            <div class="status-number">@Model.MaintenanceRooms</div>
                            <div class="status-text">Bảo Trì</div>
                        </div>
                    </div>
                </div>

                <canvas id="roomChart"></canvas>
            </div>
        </div>
    </div>

    <!-- BRANCH + USERS -->
    <div class="dashboard-grid-3">

        <!-- BRANCHES -->
        <div class="dashboard-card">
            <div class="card-header">
                <h3>🏢 Chi Nhánh</h3>
            </div>
            <div class="card-body">
                @foreach (var br in Model.Branches)
                {
                    <div class="branch-item">
                        <div class="branch-icon">📍</div>
                        <div class="branch-info">
                            <div class="branch-name">@br.BranchName</div>
                            <div class="branch-rooms">@br.RoomCount phòng</div>
                        </div>
                    </div>
                }
            </div>
        </div>

        <!-- NEW USERS -->
        <div class="dashboard-card">
            <div class="card-header">
                <h3>👥 Người Dùng Mới</h3>
            </div>
            <div class="card-body">
                @foreach (var u in Model.NewUsers)
                {
                    <div class="user-item">
                        <div class="user-avatar">👤</div>
                        <div class="user-info">
                            <div class="user-name">@u.FullName</div>
                            <div class="user-email">@u.Email</div>
                        </div>
                        <div class="user-badge">Mới</div>
                    </div>
                }
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="~/js/admin-dashboard.js" asp-append-version="true"></script>
}
